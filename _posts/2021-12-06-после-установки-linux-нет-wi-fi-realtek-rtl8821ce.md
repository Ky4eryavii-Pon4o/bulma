---
layout: post
title: После установки Linux нет Wi-Fi (Realtek RTL8821CE)
thumbnail: /img/uploads/0_u0yfxi1yftffpnjm.jpg
date: 2021-12-06 11:41:14
---
Если у вас Wi-Fi адаптер на основе чипсета **Realtek RTL8821CE**, то в Linux по умолчанию отсутствует драйвер для него. В результате ОС не видит устройство, и в панели рядом с часами вовсе отсутствует значок Wi-Fi.

С такой проблемой могут столкнуться, например, владельце ноутбуков ASUS F540M.

Для исправления данной проблемы достаточно установить необходимый драйвер.



- - -

Этот драйвер работает на ядре Linux > 4.14 (все современные дистрибутивы удовлетворяют этому требованию). Этот драйвер тестировался на Debian, Ubuntu, Linux Mint, Arch Linux, Gentoo и должен работать на всех производных дистрибутивах.

Этот драйвер может быть установлен с использованием DKMS. Эта система, которая автоматически перекомпилирует и устанавливает модули ядра когда в результате обновления устанавливается новое ядро. Для использования DKMS, установите пакет dkms.

Чтобы проверить, какой именно у вас интегрированный Wi-Fi адаптер, выполните команду

`lspci | grep` `Network`

Если у вас вывод содержит строку RTL8821CE, значит эта инструкция вам поможет:

`Network controller: Realtek Semiconductor Co., Ltd. RTL8821CE 802.11ac PCIe Wireless Network Adapter`

## Офлайн установка Realtek RTL8821CE

Если на компьютере, на который вы хотите установить драйвер, отсутствует Интернет-подключение, то вы можете скачать установочный файл из репозиториев Ubuntu, перенести его на флешке на компьютер без Интернета и попробовать установить его вручную. Этот способ может не сработать по той причине, что для установки драйвера требуются зависимости (например, заголовки ядра), которые смогли бы установиться будь у компьютера Интернет-подключение, но если компьютер офлайн, то приходится надеяться, что все нужные файлы присутствуют по умолчанию.

Скачайте установочный файл драйвера:

```
wget http://archive.ubuntu.com/ubuntu/pool/universe/r/rtl8821ce/rtl8821ce-dkms_5.5.2.1-0ubuntu4_all.deb
```

Если ссылка перестала работать, то для поиска актуального драйвера перейдите на страницу: <https://pkgs.org/search/?q=rtl8821ce-dkms>

Перенесите скаченный файл на компьютер, где его нужно установить, перейдите в директорию с драйвером и запустите установку следующей командой:

```
sudo apt install ./rtl8821ce-dkms_5.5.2.1-0ubuntu4_all.deb
```

## Установка драйвера Realtek RTL8821CE в Ubuntu 21.04 и более поздние

Драйвер помещён в стандартный репозиторий, поэтому достаточно выполнить команду:

```
sudo apt install rtl8821ce-dkms
```

## Установка драйвера Realtek RTL8821CE в Ubuntu 20.04

Начиная с Ubuntu 20.04, этот драйвер имеется в Дополнительном ПО (Additional Drivers (Software & Updates)). Откройте настройки дополнительного ПО и поставьте галочку “Using DKMS source for the Realtek 8821C …” (использовать DKMS источник для Realtek 8821C) и затем перезагрузитесь. После перезагрузки всё будет работать.

## Как установить драйвер Realtek RTL8821CE в Debian, Ubuntu, Kali Linux, Linux Mint и их производные

Выполните следующие команды:

```
sudo apt install bc module-assistant build-essential dkms
git clone https://github.com/tomaspinho/rtl8821ce
cd rtl8821ce
sudo m-a prepare
sudo ./dkms-install.sh
```

Затем перезагрузите компьютер — всё должно работать.

## Удаление драйвера

Откройте терминал и используйте git clone для клонирования репозитория на локальный диск:

```
git clone https://github.com/tomaspinho/rtl8821ce.git
cd rtl8821ce
```

Затем выполните скрипт для деинсталяции:

```
sudo ./dkms-remove.sh
```

## Возможные проблемы

### Secure Boot

Если ваша система использует безопасную загрузку, отключите её в настройках BIOS, иначе ядро не будет принимать пользовательские модули.

### PCIe Activate State Power Management

Ваш дистрибутив может поставляться с включённым по умолчанию управлением питанием активного состояния PCIe (PCIe Activate State Power Management). Это может конфликтовать с этим драйвером. Чтобы отключить:

```
sudo $EDITOR /etc/default/grub
```

Добавьте **pci=noaer** в конец **GRUB_CMDLINE_LINUX_DEFAULT**. Строка должна выглядеть примерно так:

```
GRUB_CMDLINE_LINUX_DEFAULT="quiet splash pci=noaer"
```

Затем обновите вашу конфигурацию GRUB

```
sudo update-grub
```

Перегрузитесь...